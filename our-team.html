<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Meet the Ball603 team - photographers, videographers, and writers covering New Hampshire basketball">
  <meta name="theme-color" content="#f57c00">
  <title>Our Team | Ball603</title>
  
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="apple-touch-icon" href="/logo.png">
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S4BN80729K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S4BN80729K');
  </script>
  
  <!-- Shared Styles -->
  <link rel="stylesheet" href="/styles.css">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Our Team | Ball603">
  <meta property="og:description" content="Meet the Ball603 team covering New Hampshire basketball">
  <meta property="og:image" content="https://ball603.com/logo.png">
  <meta property="og:url" content="https://ball603.com/our-team">
</head>
<body>
  
  <!-- Navigation (loaded dynamically) -->
  <div id="site-header"></div>
  <div id="mobile-menu"></div>
  <script src="/includes/nav-loader.js"></script>

  <!-- Page Header -->
  <div class="team-page-header">
    <h1 class="team-page-title">Our Team</h1>
    <p class="team-page-subtitle">The photographers, videographers, and writers bringing you New Hampshire basketball</p>
  </div>

  <!-- Contributors Grid -->
  <div class="contributors-container">
    <div class="contributors-grid" id="contributorsGrid">
      <div class="contributors-loading">Loading team...</div>
    </div>
  </div>

  <!-- Modal -->
  <div class="contributor-modal-overlay" id="modalOverlay">
    <div class="contributor-modal" id="modalContent">
      <button class="modal-close" id="modalClose">
        <svg viewBox="0 0 24 24" fill="none"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
      <div id="modalInner"></div>
    </div>
  </div>

  <!-- Site Footer -->
  <footer class="site-footer">
    <div class="footer-logo"><img src="/logo.png" alt="Ball603"></div>
    <div class="footer-links">
      <a href="/aboutus">About Us</a>
      <a href="/our-team">Our Team</a>
      <a href="/contact">Contact</a>
    </div>
    <div class="footer-social">
      <a href="https://facebook.com/ball603" target="_blank" title="Facebook"><svg viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg></a>
      <a href="https://www.instagram.com/ball603nh/" target="_blank" title="Instagram"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></a>
      <a href="https://x.com/Ball603NH" target="_blank" title="X (Twitter)"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
    </div>
    <p class="footer-copyright">&#169; 2025 Ball603. All rights reserved.</p>
  </footer>

  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.0"></script>
  
  <script>
    // Supabase initialization
    var SUPABASE_URL = 'https://suncdkxfqkwwnmhosxcf.supabase.co';
    var SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1bmNka3hmcWt3d25taG9zeGNmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwNTk4MzIsImV4cCI6MjA4MDYzNTgzMn0.aT6V8Zx_YozqOh1ZnC6x-czI9vo-QhHKmP69PgY-8xw';
    
    var db;
    var contributors = [];
    var portfolioData = {};
    
    // Role config
    var ROLES = {
      photographer: { icon: '&#128247;', label: 'Photographer' },
      videographer: { icon: '&#127909;', label: 'Videographer' },
      writer: { icon: '&#9997;&#65039;', label: 'Writer' },
      graphics: { icon: '&#127912;', label: 'Graphics' }
    };
    
    // Social SVG icons
    var SOCIAL_ICONS = {
      instagram: '<svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>',
      facebook: '<svg viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>',
      twitter: '<svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>',
      website: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>',
      link: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>'
    };
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof window.supabase === 'undefined') {
        document.getElementById('contributorsGrid').innerHTML = '<div class="contributors-loading">Error loading team data</div>';
        return;
      }
      
      db = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      loadContributors();
      setupModal();
    });
    
    function setupModal() {
      var overlay = document.getElementById('modalOverlay');
      var closeBtn = document.getElementById('modalClose');
      
      closeBtn.addEventListener('click', closeModal);
      overlay.addEventListener('click', function(e) {
        if (e.target === overlay) closeModal();
      });
      
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeModal();
      });
    }
    
    function openModal(id) {
      var c = contributors.find(function(x) { return x.id === id; });
      if (!c) return;
      
      var overlay = document.getElementById('modalOverlay');
      var inner = document.getElementById('modalInner');
      
      inner.innerHTML = buildModalContent(c);
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function closeModal() {
      var overlay = document.getElementById('modalOverlay');
      overlay.classList.remove('active');
      document.body.style.overflow = '';
    }
    
    async function loadContributors() {
      try {
        var result = await db
          .from('contributors')
          .select('*')
          .eq('active', true)
          .order('name');
        
        if (result.error) throw result.error;
        contributors = result.data || [];
        
        var portfolioResult = await db
          .from('contributor_portfolio')
          .select('*');
        
        if (!portfolioResult.error && portfolioResult.data) {
          portfolioResult.data.forEach(function(link) {
            if (!portfolioData[link.contributor_id]) {
              portfolioData[link.contributor_id] = [];
            }
            portfolioData[link.contributor_id].push(link);
          });
        }
        
        renderContributors();
        
      } catch (err) {
        console.error('Error loading contributors:', err);
        document.getElementById('contributorsGrid').innerHTML = '<div class="contributors-loading">Error loading team data</div>';
      }
    }
    
    function renderContributors() {
      var grid = document.getElementById('contributorsGrid');
      
      if (contributors.length === 0) {
        grid.innerHTML = '<div class="contributors-loading">No team members found</div>';
        return;
      }
      
      var html = '';
      contributors.forEach(function(c) {
        html += buildCard(c);
      });
      
      grid.innerHTML = html;
      
      // Attach click handlers
      var cards = document.querySelectorAll('.contributor-card');
      cards.forEach(function(card) {
        card.addEventListener('click', function(e) {
          // Don't open modal if clicking social links
          if (e.target.closest('.contributor-social a')) return;
          var id = parseInt(card.dataset.id, 10);
          openModal(id);
        });
      });
    }
    
    function buildCard(c) {
      var roles = getRoles(c);
      var social = buildSocial(c);
      
      var html = '<div class="contributor-card" data-id="' + c.id + '">';
      
      // Photo section
      html += '<div class="contributor-photo-wrap">';
      if (c.headshot_url) {
        html += '<img class="contributor-headshot" src="' + escapeHtml(c.headshot_url) + '" alt="' + escapeHtml(c.name) + '" loading="lazy">';
      } else {
        html += '<div class="contributor-photo-placeholder">&#128100;</div>';
      }
      
      // Role badges on photo
      if (roles.length > 0) {
        html += '<div class="contributor-roles">';
        roles.forEach(function(r) {
          html += '<span class="contributor-role" title="' + r.label + '">' + r.icon + '</span>';
        });
        html += '</div>';
      }
      html += '</div>';
      
      // Info section
      html += '<div class="contributor-info">';
      html += '<h3 class="contributor-name">' + escapeHtml(c.name) + '</h3>';
      
      if (c.hs_alma_mater) {
        var logo = getSchoolLogo(c.hs_alma_mater);
        html += '<div class="contributor-alma-mater">';
        if (logo) html += '<img class="contributor-alma-logo" src="' + logo + '" alt="" loading="lazy">';
        html += '<span>' + escapeHtml(c.hs_alma_mater) + '</span>';
        html += '</div>';
      }
      
      if (c.primary_area) {
        html += '<div class="contributor-coverage">' + escapeHtml(c.primary_area) + '</div>';
      }
      
      if (social) {
        html += '<div class="contributor-social">' + social + '</div>';
      }
      
      html += '</div>'; // end info
      html += '</div>'; // end card
      
      return html;
    }
    
    function buildModalContent(c) {
      var roles = getRoles(c);
      var social = buildSocial(c, true);
      var portfolio = portfolioData[c.id] || [];
      
      var html = '';
      
      // Header with photo
      html += '<div class="modal-header">';
      if (c.headshot_url) {
        html += '<img src="' + escapeHtml(c.headshot_url) + '" alt="' + escapeHtml(c.name) + '">';
      } else {
        html += '<div class="modal-header-placeholder">&#128100;</div>';
      }
      html += '<div class="modal-header-gradient"></div>';
      html += '<div class="modal-header-info">';
      html += '<h2 class="modal-name">' + escapeHtml(c.name) + '</h2>';
      if (roles.length > 0) {
        html += '<div class="modal-roles">';
        roles.forEach(function(r) {
          html += '<span class="modal-role">' + r.icon + ' ' + r.label + '</span>';
        });
        html += '</div>';
      }
      html += '</div>';
      html += '</div>';
      
      // Body
      html += '<div class="modal-body">';
      
      // Meta info
      var hasMeta = c.hs_alma_mater || c.primary_area;
      if (hasMeta) {
        html += '<div class="modal-meta">';
        if (c.hs_alma_mater) {
          var logo = getSchoolLogo(c.hs_alma_mater);
          html += '<div class="modal-meta-item">';
          if (logo) html += '<img src="' + logo + '" alt="">';
          html += '<span>' + escapeHtml(c.hs_alma_mater) + '</span>';
          html += '</div>';
        }
        if (c.primary_area) {
          html += '<div class="modal-meta-item">';
          html += '<span class="modal-meta-icon">&#128205;</span>';
          html += '<span>' + escapeHtml(c.primary_area) + '</span>';
          html += '</div>';
        }
        html += '</div>';
      }
      
      // Bio
      if (c.bio) {
        html += '<p class="modal-bio">' + escapeHtml(c.bio) + '</p>';
      }
      
      // Social
      if (social) {
        html += '<div class="modal-section-title">Connect</div>';
        html += '<div class="modal-social">' + social + '</div>';
      }
      
      // Portfolio
      if (portfolio.length > 0) {
        html += '<div class="modal-section-title">Portfolio</div>';
        html += '<div class="modal-portfolio">';
        portfolio.forEach(function(p) {
          html += '<a href="' + escapeHtml(p.url) + '" target="_blank" class="modal-portfolio-link" onclick="event.stopPropagation()">';
          html += SOCIAL_ICONS.link;
          html += '<span>' + escapeHtml(p.title || p.url) + '</span>';
          html += '</a>';
        });
        html += '</div>';
      }
      
      // Venmo
      if (c.venmo_handle) {
        html += '<div class="modal-venmo">';
        html += '<span class="modal-venmo-icon">&#128179;</span>';
        html += '<span>Support on Venmo: @' + escapeHtml(c.venmo_handle) + '</span>';
        html += '</div>';
      }
      
      html += '</div>'; // end body
      
      return html;
    }
    
    function getRoles(c) {
      var roles = [];
      if (c.is_photographer) roles.push(ROLES.photographer);
      if (c.is_videographer) roles.push(ROLES.videographer);
      if (c.is_writer) roles.push(ROLES.writer);
      if (c.is_graphics) roles.push(ROLES.graphics);
      return roles;
    }
    
    function buildSocial(c, isModal) {
      var links = [];
      if (c.instagram_url) {
        links.push('<a href="' + escapeHtml(c.instagram_url) + '" target="_blank" title="Instagram" onclick="event.stopPropagation()">' + SOCIAL_ICONS.instagram + '</a>');
      }
      if (c.facebook_url) {
        links.push('<a href="' + escapeHtml(c.facebook_url) + '" target="_blank" title="Facebook" onclick="event.stopPropagation()">' + SOCIAL_ICONS.facebook + '</a>');
      }
      if (c.twitter_url) {
        links.push('<a href="' + escapeHtml(c.twitter_url) + '" target="_blank" title="X (Twitter)" onclick="event.stopPropagation()">' + SOCIAL_ICONS.twitter + '</a>');
      }
      if (c.website_url) {
        links.push('<a href="' + escapeHtml(c.website_url) + '" target="_blank" title="Website" onclick="event.stopPropagation()">' + SOCIAL_ICONS.website + '</a>');
      }
      return links.join('');
    }
    
    function getSchoolLogo(name) {
      if (!name) return null;
      var filename = name.replace(/\s+/g, '').replace(/[^a-zA-Z0-9]/g, '');
      return '/logos/100px/' + filename + '.png';
    }
    
    function escapeHtml(str) {
      if (!str) return '';
      var div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }
  </script>

</body>
</html>
