<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Meet the Ball603 team - photographers, videographers, and writers covering New Hampshire basketball">
  <meta name="theme-color" content="#f57c00">
  <title>Our Team | Ball603</title>
  
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="apple-touch-icon" href="/logo.png">
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S4BN80729K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S4BN80729K');
  </script>
  
  <!-- Shared Styles -->
  <link rel="stylesheet" href="/styles.css">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Our Team | Ball603">
  <meta property="og:description" content="Meet the Ball603 team covering New Hampshire basketball">
  <meta property="og:image" content="https://ball603.com/logo.png">
  <meta property="og:url" content="https://ball603.com/our-team">
</head>
<body>
  
  <!-- Navigation (loaded dynamically) -->
  <div id="site-header"></div>
  <div id="mobile-menu"></div>
  <script src="/includes/nav-loader.js"></script>

  <!-- Page Header -->
  <div class="team-page-header">
    <h1 class="team-page-title">Our Team</h1>
    <p class="team-page-subtitle">The photographers, videographers, and writers behind Ball603</p>
  </div>

  <!-- Contributors Grid -->
  <div class="contributors-container">
    <div class="contributors-grid" id="contributorsGrid">
      <div class="contributors-loading">Loading team...</div>
    </div>
  </div>

  <!-- Site Footer -->
  <footer class="site-footer">
    <div class="footer-logo"><img src="/logo.png" alt="Ball603"></div>
    <div class="footer-links">
      <a href="/aboutus">About Us</a>
      <a href="/our-team">Our Team</a>
      <a href="/contact">Contact</a>
    </div>
    <div class="footer-social">
      <a href="https://facebook.com/ball603" target="_blank" title="Facebook"><svg viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg></a>
      <a href="https://www.instagram.com/ball603nh/" target="_blank" title="Instagram"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></a>
      <a href="https://x.com/Ball603NH" target="_blank" title="X (Twitter)"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
    </div>
    <p class="footer-copyright">&copy; 2025 Ball603. All rights reserved.</p>
  </footer>

  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.0"></script>
  
  <script>
    // Supabase initialization
    const SUPABASE_URL = 'https://suncdkxfqkwwnmhosxcf.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1bmNka3hmcWt3d25taG9zeGNmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwNTk4MzIsImV4cCI6MjA4MDYzNTgzMn0.aT6V8Zx_YozqOh1ZnC6x-czI9vo-QhHKmP69PgY-8xw';
    
    let db;
    let contributors = [];
    let portfolioData = {};
    
    // Role icons using HTML entities
    const ROLE_ICONS = {
      photographer: '&#128247;',
      videographer: '&#127909;',
      writer: '&#9997;&#65039;',
      graphics: '&#127912;'
    };
    
    // Social SVG icons
    const SOCIAL_ICONS = {
      instagram: '<svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>',
      facebook: '<svg viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>',
      twitter: '<svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>',
      website: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>',
      link: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>'
    };
    
    // Initialize on DOM ready
    document.addEventListener('DOMContentLoaded', async function() {
      // Wait for Supabase to load
      if (typeof window.supabase === 'undefined') {
        console.error('Supabase not loaded');
        document.getElementById('contributorsGrid').innerHTML = '<div class="contributors-loading">Error loading team data</div>';
        return;
      }
      
      db = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      await loadContributors();
    });
    
    async function loadContributors() {
      try {
        // Fetch active contributors
        const { data: contribData, error: contribError } = await db
          .from('contributors')
          .select('*')
          .eq('active', true)
          .order('name');
        
        if (contribError) throw contribError;
        contributors = contribData || [];
        
        // Fetch all portfolio links
        const { data: portfolioLinks, error: portfolioError } = await db
          .from('contributor_portfolio')
          .select('*');
        
        if (!portfolioError && portfolioLinks) {
          portfolioLinks.forEach(function(link) {
            if (!portfolioData[link.contributor_id]) {
              portfolioData[link.contributor_id] = [];
            }
            portfolioData[link.contributor_id].push(link);
          });
        }
        
        renderContributors();
        
      } catch (err) {
        console.error('Error loading contributors:', err);
        document.getElementById('contributorsGrid').innerHTML = '<div class="contributors-loading">Error loading team data</div>';
      }
    }
    
    function renderContributors() {
      var grid = document.getElementById('contributorsGrid');
      
      if (contributors.length === 0) {
        grid.innerHTML = '<div class="contributors-loading">No team members found</div>';
        return;
      }
      
      var html = '';
      
      contributors.forEach(function(c) {
        html += buildContributorCard(c);
      });
      
      grid.innerHTML = html;
      
      // Add click handlers for expand/collapse
      var cards = document.querySelectorAll('.contributor-card');
      cards.forEach(function(card) {
        var header = card.querySelector('.contributor-header');
        header.addEventListener('click', function() {
          card.classList.toggle('expanded');
        });
      });
    }
    
    function buildContributorCard(c) {
      var roles = buildRoles(c);
      var social = buildSocial(c);
      var portfolio = portfolioData[c.id] || [];
      var hasDetails = c.bio || portfolio.length > 0 || c.venmo_handle;
      
      var html = '<div class="contributor-card" data-id="' + c.id + '">';
      html += '<div class="contributor-header">';
      
      // Headshot
      if (c.headshot_url) {
        html += '<img class="contributor-headshot" src="' + escapeHtml(c.headshot_url) + '" alt="' + escapeHtml(c.name) + '">';
      } else {
        html += '<div class="contributor-headshot-placeholder">&#128100;</div>';
      }
      
      html += '<div class="contributor-info">';
      
      // Name
      html += '<h3 class="contributor-name">' + escapeHtml(c.name) + '</h3>';
      
      // Roles
      if (roles) {
        html += '<div class="contributor-roles">' + roles + '</div>';
      }
      
      // Alma mater
      if (c.hs_alma_mater) {
        var logoPath = getSchoolLogoPath(c.hs_alma_mater);
        html += '<div class="contributor-alma-mater">';
        if (logoPath) {
          html += '<img class="contributor-alma-logo" src="' + logoPath + '" alt="">';
        }
        html += '<span>' + escapeHtml(c.hs_alma_mater) + '</span>';
        html += '</div>';
      }
      
      // Coverage area
      if (c.primary_area) {
        html += '<div class="contributor-coverage">' + escapeHtml(c.primary_area) + '</div>';
      }
      
      // Social links
      if (social) {
        html += '<div class="contributor-social">' + social + '</div>';
      }
      
      html += '</div>'; // End contributor-info
      
      // Expand button (only if has details)
      if (hasDetails) {
        html += '<div class="contributor-expand">';
        html += '<svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>';
        html += '</div>';
      }
      
      html += '</div>'; // End contributor-header
      
      // Expandable details
      if (hasDetails) {
        html += '<div class="contributor-details">';
        html += '<div class="contributor-details-inner">';
        
        // Bio
        if (c.bio) {
          html += '<p class="contributor-bio">' + escapeHtml(c.bio) + '</p>';
        }
        
        // Portfolio
        if (portfolio.length > 0) {
          html += '<div class="contributor-portfolio">';
          html += '<div class="contributor-portfolio-title">Portfolio</div>';
          html += '<div class="contributor-portfolio-list">';
          portfolio.forEach(function(p) {
            html += '<a href="' + escapeHtml(p.url) + '" target="_blank" class="contributor-portfolio-link">';
            html += SOCIAL_ICONS.link;
            html += '<span>' + escapeHtml(p.title || p.url) + '</span>';
            html += '</a>';
          });
          html += '</div>';
          html += '</div>';
        }
        
        // Venmo
        if (c.venmo_handle) {
          html += '<div class="contributor-venmo">';
          html += '<span class="contributor-venmo-icon">&#128179;</span>';
          html += '<span>Venmo: @' + escapeHtml(c.venmo_handle) + '</span>';
          html += '</div>';
        }
        
        html += '</div>'; // End details-inner
        html += '</div>'; // End details
      }
      
      html += '</div>'; // End card
      
      return html;
    }
    
    function buildRoles(c) {
      var roles = [];
      if (c.is_photographer) roles.push('<span class="contributor-role" title="Photographer">' + ROLE_ICONS.photographer + '</span>');
      if (c.is_videographer) roles.push('<span class="contributor-role" title="Videographer">' + ROLE_ICONS.videographer + '</span>');
      if (c.is_writer) roles.push('<span class="contributor-role" title="Writer">' + ROLE_ICONS.writer + '</span>');
      if (c.is_graphics) roles.push('<span class="contributor-role" title="Graphics">' + ROLE_ICONS.graphics + '</span>');
      return roles.join('');
    }
    
    function buildSocial(c) {
      var links = [];
      if (c.instagram_url) {
        links.push('<a href="' + escapeHtml(c.instagram_url) + '" target="_blank" title="Instagram">' + SOCIAL_ICONS.instagram + '</a>');
      }
      if (c.facebook_url) {
        links.push('<a href="' + escapeHtml(c.facebook_url) + '" target="_blank" title="Facebook">' + SOCIAL_ICONS.facebook + '</a>');
      }
      if (c.twitter_url) {
        links.push('<a href="' + escapeHtml(c.twitter_url) + '" target="_blank" title="X (Twitter)">' + SOCIAL_ICONS.twitter + '</a>');
      }
      if (c.website_url) {
        links.push('<a href="' + escapeHtml(c.website_url) + '" target="_blank" title="Website">' + SOCIAL_ICONS.website + '</a>');
      }
      return links.join('');
    }
    
    function getSchoolLogoPath(schoolName) {
      if (!schoolName) return null;
      // Convert school name to logo filename format
      var filename = schoolName
        .replace(/\s+/g, '')
        .replace(/[^a-zA-Z0-9]/g, '');
      return '/logos/100px/' + filename + '.png';
    }
    
    function escapeHtml(str) {
      if (!str) return '';
      var div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }
  </script>

</body>
</html>
